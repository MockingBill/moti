var mysql_utils = require('../../common/utils/mysql_utils')();

/**
 * 分页查询机构列表
 */
exports.pagingOrgList=function(params) {

    var sql = 'select a.*, b.area_name, b.area_full_name, get_dict_text(\'common_org_type\', a.org_type) as org_type_name from common_org_info a left join common_area_info b on a.org_area_id = b.area_id ';
    var order = ' order by a.org_sort ';
    var where = ' where 1 = 1 ';
    var countSql = 'select count(1) as total FROM common_org_info a ';

    var whereParam = [];
    if(params.org_name) {
        where += ' and a.org_name like ? '
        whereParam.push('%' + params.org_name + '%');
    }

    return mysql_utils.pagingQuery(sql + where + order, countSql + where, whereParam, params.page, params.limit, 0);
}


/*
exports.pagingOrgList({page:1, size:10})
    .then(function(result){
        console.log(result);
    })
    .catch(function(error){
        console.log(error);
    });*/
